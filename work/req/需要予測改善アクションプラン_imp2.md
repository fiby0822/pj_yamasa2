# 需要予測プロジェクト改善アクションプラン（2025-01〜03 imp2）

## 1. 現状整理
- 対象 SKU は 98 件。`report_2025-01_to_03_imp2/summary/accuracy_summary.csv` によると Simple Error の平均は 40.3%、中央値は 32.5%、MAPE 平均は 50.4% と全体的にばらつきが大きい。
- 出荷上位 10 SKU で全体出荷量の 52.7% を占める一方、Simple Error は 13.7〜31.3% と中程度。主要商材の精度改善がそのままビジネス効果に直結する。
- Simple Error 50% 超の SKU は 19 件（全出荷量の 2.6%）。ボリュームは小さいが誤差が極端に大きく、長期的な信頼性を損なう。
- 出荷量 6,000 本未満の長尾 SKU では Simple Error が 70% 超（例: A188460, A160600）。需要ゼロ期間の扱いや外乱イベントを捉えられていない可能性が高い。
- 現行レポートでは外部要因や販促イベントを扱う特徴量がなく、予測モデルも単一手法のまま運用されていると推察される。

## 2. 改善アクションの全体像
| カテゴリ | 狙い | 代表アクション |
| --- | --- | --- |
| 外部データ | 季節性・外部要因の取り込み | 気象/気温、行楽イベント、販促カレンダー、原材料価格、広告出稿情報 |
| 対象商品の拡大 | モデル適用範囲・学習量の拡張 | 取扱高の大きい派生 SKU、出荷チャネル別モデル、需要階層モデル化 |
| モデル精度向上 | 手法・運用の高度化 | モデル比較・アンサンブル、異常値補正と再学習、検証フレーム刷新 |
| 特徴量開発 | 既存データの情報量強化 | 価格弾力、プロモフラグ、顧客セグメント、在庫・リードタイム特徴量 |
| その他 | MLOps・業務連携強化 | モニタリング、アラート、自動検知、意思決定サイクル改善 |

以下でカテゴリ別に詳細を整理する。

## 3. 外部データ取り込み
1. **気象・気温データの導入（高優先/短期）**  
   - ソース: 気象庁、ウェザーニューズ API 等。  
   - 効果想定: 調味料・鍋つゆなど季節性の高い SKU で誤差 2〜5pt 改善。  
   - 対応: エリア別平均気温、降水量、祝日前後の気象イベントを週次集計し、ラグ特徴量として投入。
2. **販促/広告施策データの統合（中期）**  
   - 売上計画部門が管理するチラシ・TV/デジタル広告日程を連携。  
   - プロモーション有無・割引率を特徴量化し、上位 10 SKU の需要急増を捕捉。
3. **需要シグナルの補強（中期）**  
   - POS/EC 売れ筋ランキング、口コミ、検索ボリュームなど外部需要シグナルを導入。  
   - 需要トレンド転換点の早期検知に活用。
4. **サプライ側データの連携（長期）**  
   - 在庫量、製造計画、出荷制限等の制約情報を併合し、過去の供給制約によるデータ歪みを補正。

## 4. 対象商品の拡大
1. **上位 SKU の派生品・容量違いの追加（短期）**  
   - 既にモデル化されている SKU の近似品を追加し、クラスタ単位で学習量を確保。  
   - 共通特徴量（味、用途、容量等）で転移学習を適用。
2. **チャネル別モデル化（中期）**  
   - 業務用/家庭用・エリア別など、需要特性が異なるチャネルを分離して学習。  
   - 高出荷 SKU のチャネル偏差を可視化し、精度改善と在庫配置最適化を両立。
3. **階層型需要予測（長期）**  
   - SKU→カテゴリ→ブランドといった階層整合性を保つモデルを導入してドリルダウン精度を確保。  
   - 集約レベルでの精度担保により、営業計画との整合を取りやすくする。

## 5. モデル精度向上
1. **ベースラインの刷新とモデル比較（短期）**  
   - 現行モデルに対して LightGBM/XGBoost、Prophet、DeepAR など複数アルゴリズムを評価。  
   - 主要 KPI: sMAPE、Simple Error、在庫コストシミュレーション。
2. **アンサンブルとメタ学習（中期）**  
   - 週次トレンドと季節性を捉えるモデルを組み合わせ、上位 SKU に限定した加重アンサンブルを検討。  
   - モデル信頼度（予測分散）を出力し、運用にリスク指標を提供。
3. **異常値補正・再学習パイプライン（短期）**  
   - 欠品・販促起因のスパイクを自動タグ付けし、学習時に補正または分岐モデルで学習。  
   - 特に Simple Error が高い長尾 SKU に対して、Zero-inflated/Intermittent 需要モデル（Croston 系）を適用。
4. **評価フレームの高度化（中期）**  
   - 時系列クロスバリデーション（Rolling Origin）を標準化し、過去データに対する過学習を検出。  
   - ビジネス KPI（欠品率・在庫回転日数）を評価指標へ統合。

## 6. 特徴量開発
1. **価格・販促特徴量（短期）**  
   - 販売価格、値引率、販促実施フラグを週次で集計。価格変動が小さい品目も「価格変更有無」で需要変動を捕捉。
2. **顧客セグメント/得意先属性（中期）**  
   - 需要が集中する得意先のカテゴリ（業態、規模、地域）を特徴量化。大型顧客の発注周期を学習。  
   - チャネル別予測に連動。
3. **在庫・リードタイム関連（中期）**  
   - 物流システムから在庫日数、欠品発生フラグ、リードタイムを取得。欠品で実績が削られた期間を補正。
4. **広域イベント・カレンダー（短期）**  
   - 祝日、連休、季節イベント、年度切替など、需要影響の大きいカレンダーをフラグ化。  
   - 地域イベント・観光シーズンは後述の外部データと組み合わせる。
5. **競合・カテゴリ指標（長期）**  
   - 小売 POS データや市場調査のカテゴリ成長率を特徴量化し、需要トレンドを先読み。

## 7. その他（運用・体制強化）
1. **モニタリングとアラート設計（短期）**  
   - 週次 Simple Error、MAPE、在庫影響をダッシュボード化。閾値越えでアラート通知し、アナリストが介入。  
   - 特に長尾 SKU の極端な誤差を早期検知して対処。
2. **データ品質/ガバナンス整備（短期）**  
   - 入庫・出庫データの欠損、データ遅延を監視する QC チェックリストを実装。  
   - マスタ（SKU、得意先、カテゴリ）の ID 統合・履歴管理。
3. **ビジネス部門とのフィードバックループ（中期）**  
   - 需要計画チームと週次レビュー会議を設置。モデル予測と現場知見（販促、欠品、競合動向）を相互反映。  
   - 指標や改善インパクトを共有して PDCA を高速化。
4. **MLOps 基盤整備（長期）**  
   - モデル学習・推論パイプラインのスケジューリング、自動再学習、バージョン管理を整備。  
   - Feature Store 化や MLflow によるトラッキングで実験効率を向上。
5. **リスク管理・需要シナリオプランニング（長期）**  
   - 価格改定・為替・サプライ制約などのシナリオ分析機能を拡張し、営業との合意形成に活用。  
   - モデルの不確実性（予測区間）を提示し、意思決定を支援。

## 8. 優先度とロードマップ（提案）
| フェーズ | 期間目安 | 主なタスク | 期待効果 |
| --- | --- | --- | --- |
| フェーズ1（0〜3ヶ月） | 短期 | 気象データ連携、異常値補正、ベースライン比較、モニタリング導入 | Top10 SKU Simple Error を 3〜5pt 改善、現状可視化の強化 |
| フェーズ2（3〜6ヶ月） | 中期 | プロモ・価格特徴量、チャネル別モデル、アンサンブル実装、品質チェック自動化 | 在庫偏差・欠品率改善、長尾 SKU の安定化 |
| フェーズ3（6ヶ月以降） | 長期 | 階層型モデル、外部需要シグナル統合、MLOps/Feature Store、シナリオ分析 | 継続的な精度改善と運用効率化、経営意思決定支援の高度化 |

## 9. 次アクション（サマリ）
1. **データ連携キックオフ**: 気象・販促カレンダー・価格データの収集チームを編成し、取得・連携スケジュールを決定。  
2. **モデル改善 PoC 設計**: 現行 imp2 モデルをベンチマークとし、LightGBM/Prophet/Croston の比較実験を 4 週間で実施。  
3. **モニタリング基盤構築**: Simple Error/SPAE 推移とアラートを Tableau/Looker Studio などで可視化。  
4. **長尾 SKU ワーキンググループ**: 出荷量 6,000 本未満かつ Simple Error 70% 超の SKU を対象に、補完策とビジネス判断（統合/除外）を検討。  
5. **ロードマップ合意**: 本プランを関係部門と共有し、優先度・リソース・ KPI を確定。

作成日: 2025-10-23  
作成者: 需要予測改善タスクフォース（案）
